
Private Sub tbxQuery_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
Const VK_CONTROL = &H11
Const VK_SHIFT = &H10
Const VK_ALT = &H12

'    'Q query
'    If KeyCode = 81 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then ExecuteQuery tbxQuery.SelText
    'D delete
    If KeyCode = 68 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then ActiveSheet.Delete
    'E execute
    If KeyCode = 69 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then
        ThisWorkbook.Sheets(tbxSht.Text).Cells.Clear
        Call QueryExcel(tbxQuery.Text, tbxPath.Text, tbxSht.Text)
    End If
    'L execute
    If KeyCode = 76 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then
        ThisWorkbook.Sheets(tbxSht.Text).Cells.Clear
        Call QueryExcel(tbxQuery.SelText, tbxPath.Text, tbxSht.Text)
    End If
    'N GetActiveShtName
    If KeyCode = 78 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then tbxQuery.Text = tbxQuery.Value & "[" & ActiveSheet.Name & "$]"
    'G
'    If KeyCode = 71 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then tbxQuery.Text = tbxQuery.Value & "[" & ActiveSheet.Name & "$]"

    'move to Preview sheet
    If KeyCode = 37 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then PrevSht
    'move to Next sheet
    If KeyCode = 39 And GetKeyState(VK_CONTROL) < 0 And GetKeyState(VK_ALT) < 0 Then NextSht


'Debug.Print KeyCode
End Sub


'QUERY MEMO =============================================================
'SELECT first_name & " " & last_name as [new_column]
'FROM [au-500$]

'SELECT
'S1.COL1,
'S1.COL1 & " " & S1.COL2 as [NEW_COL]
'FROM [SAMPLE1$] as S1
'WHERE S1.COL1 = "1-ROW9-1"

'COL A, B ONLY
'SELECT *
'FROM [SAMPLE1$A1:B12] as S1

'Row 2 ~
'SELECT *
'FROM [SAMPLE1$A2:B12] as S1

''NG
'SELECT
'S1.COL1,
'S1.COL2 & " " & S1.COL3 as [COL2_COL3],
'S1.COL4 as [C4]
'FROM [SAMPLE1$] as S1
'LEFT JOIN [SAMPLE2$] as S2 ON S2.[CLO5] = S1.COL5
'WHERE S1.[COL5] = "AAA"

'UNION => NEED SAME TABLE COLUMN FIELD,
'SELECT *
'FROM [SAMPLE1$]
'Union ALL
'SELECT *
'FROM [SAMPLE2$]

'SELECT DISTINCT *
'FROM [SAMPLE1$]

'INSERT INTO [SAMPLE1$] (COL1, COL2)
'VALUES("NEW_COL1","NEW_COL2")

'Update [SAMPLE1$]
'Set COL2 = "UPDATE_COL2"
'WHERE COL1 = "NEW_COL1"

'SELECT *
'FROM [SAMPLE1$] as S1
'WHERE S1.COL5 Is Not Null

'SELECT
'ONCONDITION,
'CM0 , CM6
'FROM [alarm_master$] as AM
'WHERE AM.ONCONDITION Is Not Null
