Function Dev2Cmt(inpt As String) As String
'PLC03.M.M00800

Dim sFind As String
Dim sDev As String
Dim sKey As String

sFind = fSplit(inpt, 3, ".")
sFind = fReplaceRegx(sFind, "[A-Z]+", "")
sFind = fSplit(sFind, 1, "@")
sFind = CInt(sFind)
sDev = sFind

If sFind > 999 Then
    sFind = Left(sFind, Len(sFind) - 2) & Application.WorksheetFunction.Rept(0, 2)
ElseIf sFind < 1000 And sFind > 99 Then
    sFind = Left(sFind, 1) & Application.WorksheetFunction.Rept(0, Len(sFind) - 1)
Else
    sFind = 100
End If

If fSplit(inpt, 1, ".") = "PLC03" Then
    sKey = "3KEI_" & fSplit(inpt, 2, ".") & sFind
ElseIf fSplit(inpt, 1, ".") = "PLC00" Then
    sKey = "KYOTU_" & fSplit(inpt, 2, ".") & sFind
End If

Dev2Cmt = fKey2Val(sKey, fSplit(inpt, 2, ".") & fDigitN(sDev, 4))

End Function


Function keiki2Cmt(inpt As String) As String

Dim sWbName As String
Dim sWsname As String
Dim sRslt As String

On Error Resume Next
    
    If key2val("keiki3Kei", inpt) <> "" Then
        sRslt = key2val("keiki3Kei", inpt)
    ElseIf key2val("keikiKyotu", inpt) <> "" Then
        sRslt = key2val("keikiKyotu", inpt)
    Else
        sRslt = "#N/A#"
    End If

keiki2Cmt = sRslt

End Function





