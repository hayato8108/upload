'210618
'_Index  Object  Top Left    Width   Height  LibraryClass    _Text   _TagIn  _TagInColor _TagInVisible   _OpenPic    _Run    _Mes1   _Mes2   _Img    _Hi _Lo

'mod_pc config, after delete
Function pA2fA(inpt As String) As String
    pA2fA = fKey2Val("index", inpt)
End Function

Function io2plc03(inpt As String) As String
    io2plc03 = WorksheetFunction.Substitute(inpt, "X", "PLC03.X.X00")
End Function

Function io2plc00(inpt As String) As String
    io2plc00 = WorksheetFunction.Substitute(inpt, "X", "PLC00.X.X00")
End Function


'mod_ws
Sub downloadXml()
Dim d As clsXapDebug: Set d = New clsXapDebug
Dim f As IXMLDOMSelection
Dim sFol As String: sFol = ""
'Dim sFrm As String: sFrm = ""
Dim sCid As String
Dim l As Long
'sFol = "_Graphic"
'sFrm = "DFR0001"
sFol = "Folder01"

Set f = d.getFolder(sFol)

Call d.downloadXml(f)

'Cells(ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row, 1).Activate
'Do Until ActiveCell.Row = 1
'    If Cells(ActiveCell.Row, Columns("H").Column) = "" Then ''''''''''condition
'        ActiveCell.EntireRow.Select
'        Selection.Delete Shift:=xlUp
'    End If
'ActiveCell.Offset(-1, 0).Activate
'Loop

Set d = Nothing
Set f = Nothing
Set fr = Nothing

End Sub

Sub createFixFilter()
'Application.ScreenUpdating = False
Dim C As clsXapDebug
'If Not ActiveSheet.Tab.ColorIndex = -4142 Then Stop
With Worksheets.Add
    .Range(Cells(1, 1), Cells(1, Columns("R").Column)).Value2 = Split("_Index,Object,Top,Left,Width,Height,LibraryClass,_Text,_TagIn,_TagInColor,_TagInVisible,_OpenPic,_Run,_Mes1,_Mes2,_Img,_Hi,_Lo", ",")
    Set C = New clsXapDebug
        C.downloadFixReport
        C.createFixFilterXml
        Set C = Nothing
    .Delete
End With
Application.ScreenUpdating = False
End Sub


Sub createFixFilterB()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
'If Not ActiveSheet.Tab.ColorIndex = -4142 Then Stop
Dim C As clsXapDebug: Set C = New clsXapDebug
Dim path As String: path = fGetVal("fix_repo_dir"): If path = "#N\A#" Then Stop
Dim vFiles As FileDialog: Set vFiles = Application.FileDialog(msoFileDialogFilePicker)
Dim vSelectFiles As FileDialogSelectedItems
Dim vCnt As Long
Dim sRet As String

With vFiles
    .Filters.Clear
'    .Filters.Add "pictureFile", "*.*", 1
    '.Title = "FILE SELECT"
    .AllowMultiSelect = True
    .InitialFileName = path
    .show
End With

'On Error Resume Next

For vCnt = 1 To vFiles.SelectedItems.Count ' 1 base array
     sRet = fSetVal("fix_repoIn_path", vFiles.SelectedItems(vCnt))
     sRet = fSetVal("fix_repoOut_path", fReplace(vFiles.SelectedItems(vCnt), ".ODR", ".xml"))
    With Worksheets.Add
        .Range(Cells(1, 1), Cells(1, Columns("R").Column)).Value2 = Split("_Index,Object,Top,Left,Width,Height,LibraryClass,_Text,_TagIn,_TagInColor,_TagInVisible,_OpenPic,_Run,_Mes1,_Mes2,_Img,_Hi,_Lo", ",")
            C.downloadFixReport
            C.createFixFilterXml
            .Delete
    End With
Next vCnt

Set C = Nothing
Application.ScreenUpdating = True
Application.DisplayAlerts = True
End Sub

